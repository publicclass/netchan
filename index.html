<h1>netchan</h1>

<p><a href="https://travis-ci.org/publicclass/netchan"><img src="https://travis-ci.org/publicclass/netchan.png?branch=master" alt="Build Status" /></a></p>

<p>  A NetChan implementation wrapping an unreliable DataChannel.</p>

<p>  It encodes binary messages (either a <code>TypedArray</code> or an <code>ArrayBuffer</code>) and adds a sequence to it to make sure they will be delivered.</p>

<h2>Installation</h2>

<pre><code>$ component install publicclass/netchan
</code></pre>

<h2>API</h2>

<h3>new NetChannel(channel)</h3>

<p>  Create a NetChannel instance. Pass in the <code>DataChannel</code> instance that will send the encoded messages.</p>

<h3>NetChannel#onmessage(msg)</h3>

<p>  A callback which will be called with any new decoded message received from the <code>DataChannel</code>.</p>

<h3>NetChannel#send(msg)</h3>

<p>  Adds a <code>msg</code> to the buffer which is encoded and then sent over the <code>DataChannel</code>.</p>

<h2>Example</h2>

<pre><code>var pc = new PeerConnection(null)
var channel = pc.createDataChannel('netchan',{reliable: false})
var netchan = new NetChannel(channel);

var buf = new ArrayBuffer(4)
  , dat = new DataView(buf);
dat.setUint8(0,1)
dat.setUint8(1,2)
dat.setUint8(2,3)
dat.setUint8(3,4)

netchan.onmessage = function(msg){
  var dat = new DataView(msg);
  dat.getUInt8(0) // 1
  dat.getUInt8(1) // 2
  dat.getUInt8(2) // 3
  dat.getUInt8(3) // 4
}

// only binary supported by NetChannel
netchan.send(buf);
</code></pre>

<h2>Testing</h2>

<p>  See the online tests <a href="test/test.html">here</a>.</p>

<p>  Because Node 0.8 lacks ArrayBuffer#slice it must be ran with Node 0.9.4+ but it will fail on 0.9.7 because of <a href="https://github.com/joyent/node/issues/4626">a regression</a>.</p>

<p>  To unit test simply run:</p>

<pre><code>$ make
</code></pre>

<p>  To run a simple DataChannel test in your browser open <code>dc.html</code>. It uses a base64 wrapper to bypass the current lack of binary support in DataChannel so you&rsquo;ll be required to build a dev version first.</p>

<pre><code>$ component install --dev
$ component build --dev
$ open dc.html
</code></pre>

<h2>License</h2>

<p>  MIT</p>
